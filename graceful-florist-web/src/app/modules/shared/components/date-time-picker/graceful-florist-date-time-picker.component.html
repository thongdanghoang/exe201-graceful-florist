<div class="max-w-max">
    <mat-accordion>
        <mat-expansion-panel
            (opened)="panelOpenState.set(true)"
            (closed)="panelOpenState.set(false)"
        >
            <mat-expansion-panel-header>
                <mat-panel-title>{{ formatDate(selected) }}</mat-panel-title>
                <mat-panel-description>
                    {{ selectedChip ?? "Chọn giờ" }}
                </mat-panel-description>
            </mat-expansion-panel-header>
            <div class="flex flex-row gap-5">
                <div class="date-picker">
                    <mat-card class="demo-inline-calendar-card">
                        <mat-calendar [(selected)]="selected"></mat-calendar>
                    </mat-card>
                </div>
                <mat-divider [vertical]="true"></mat-divider>
                <div class="flex flex-col justify-around">
                    <div class="flex flex-col gap-2">
                        <mat-chip-listbox
                            class="mat-mdc-chip-set-stacked"
                            aria-label="Color selection"
                            (change)="selectChip($event)"
                        >
                            <div class="grid grid-cols-2 gap-2">
                                @for (chip of availableColors; track chip) {
                                    <mat-chip-option [color]="chip.color"
                                        >{{ chip.name }}
                                    </mat-chip-option>
                                }
                            </div>
                        </mat-chip-listbox>
                        @if ("Tùy Chọn" === selectedChip) {
                            <mat-form-field>
                                <mat-label>Enter a date range</mat-label>
                                <mat-date-range-input
                                    [formGroup]="range"
                                    [rangePicker]="picker"
                                >
                                    <input
                                        matStartDate
                                        formControlName="start"
                                        placeholder="Start date"
                                    />
                                    <input
                                        matEndDate
                                        formControlName="end"
                                        placeholder="End date"
                                    />
                                </mat-date-range-input>
                                <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
                                <mat-datepicker-toggle
                                    matIconSuffix
                                    [for]="picker"
                                ></mat-datepicker-toggle>
                                <mat-date-range-picker
                                    #picker
                                ></mat-date-range-picker>

                                @if (
                                    range.controls.start.hasError(
                                        "matStartDateInvalid"
                                    )
                                ) {
                                    <mat-error>Invalid start date</mat-error>
                                }
                                @if (
                                    range.controls.end.hasError(
                                        "matEndDateInvalid"
                                    )
                                ) {
                                    <mat-error>Invalid end date</mat-error>
                                }
                            </mat-form-field>
                        }
                    </div>
                    <p class="max-w-md">
                        Dịch vụ theo lịch trình: phụ thu thêm 40.000 VNĐ, thời
                        gian vận chuyển sai số từ 15-20 phút
                    </p>
                    <button
                        mat-flat-button
                        color="primary"
                        (click)="closePanel()"
                    >
                        Xác Nhận
                    </button>
                </div>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
</div>
